drop table FILM_CAST;
drop table FILM_REVIEW;
drop table FILM_GENRES;
drop table FILM;
drop table ACTORS;
drop table USERS;
drop table GENRE

commit;
  
  
-- Users
  CREATE TABLE USERS
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	Email NVARCHAR2(256) NOT NULL, 
	Username NVARCHAR2(64) NOT NULL, 
	Password_hash NVARCHAR2(256) NOT NULL, 
	Role NVARCHAR2(64) NOT NULL CHECK(Role in ('USER', 'ADMIN')),
	 CONSTRAINT "PK_User" PRIMARY KEY ("ID")
   )  ;
  
-- Films
  CREATE TABLE FILM
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1,
	Title NVARCHAR2(256) NOT NULL, 
	Description NVARCHAR2(2000) NOT NULL, 
	Director NVARCHAR2(64) NOT NULL, 
	Country NVARCHAR2(64) NOT NULL, 
	Release Date NOT NULL, 
	Budget NUMBER(10,0) NOT NULL, 
	Fees NUMBER(10,0) NOT NULL, 
	 CONSTRAINT "PK_Film" PRIMARY KEY (ID)
   );
   
-- Actors
  CREATE TABLE ACTOR
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	Name NVARCHAR2(64) NOT NULL, 
	Surname NVARCHAR2(64) NOT NULL, 
	Country NVARCHAR2(64) NOT NULL, 
	Bday DATE, 
	 CONSTRAINT "PK_Actor" PRIMARY KEY (ID)
   );

-- Genre    
  CREATE TABLE GENRE
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	Name NVARCHAR2(64) NOT NULL, 
	 CONSTRAINT "PK_Genre" PRIMARY KEY (ID)
   );

-- Film genres
  CREATE TABLE FILM_GENRES
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	FILM_ID NUMBER(10,0) NOT NULL, 
	GENRE_ID NUMBER(10,0) NOT NULL, 
	 CONSTRAINT "PK_FilmGenres" PRIMARY KEY (ID),
	 CONSTRAINT "FK_FilmGenres_Film_FilmId" FOREIGN KEY (FILM_ID)
	  REFERENCES FILM (ID) , 
	 CONSTRAINT "FK_FilmGenres_Genre_GenreId" FOREIGN KEY (GENRE_ID)
	  REFERENCES GENRE (ID) 
   );

  CREATE INDEX "IX_FilmGenres_FilmId" ON FILM_GENRES (FILM_ID);

  CREATE INDEX "IX_FilmGenres_GenreId" ON FILM_GENRES (GENRE_ID);

-- Film reviews
  CREATE TABLE FILM_REVIEW
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	Review NVARCHAR2(2000), 
	Score NUMBER(10,0) NOT NULL, 
	Published Date NOT NULL, 
	FILM_ID NUMBER(10,0) NOT NULL, 
	USER_ID NUMBER(10,0) NOT NULL, 
	 CONSTRAINT "PK_FilmReview" PRIMARY KEY (ID), 
	 CONSTRAINT "FK_FilmReview_Films_FilmID" FOREIGN KEY (FILM_ID)
	  REFERENCES Film (ID), 
	 CONSTRAINT "FK_FilmReview_Users_UserID" FOREIGN KEY (USER_ID)
	  REFERENCES Users (ID)
   );

  CREATE INDEX "IX_FilmReview_FilmID" ON FILM_REVIEW (FILM_ID);
  
  CREATE INDEX "IX_FilmReview_UserID" ON FILM_REVIEW (USER_ID);

-- Film cast
  CREATE TABLE FILM_CAST
   (	
    ID NUMBER(10,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1, 
	Role_type NVARCHAR2(64) NOT NULL, 
	Role_name NVARCHAR2(128) NOT NULL, 
	ACTOR_ID NUMBER(10,0) NOT NULL, 
	FILM_ID NUMBER(10,0) NOT NULL, 
	 CONSTRAINT "PK_FilmCast" PRIMARY KEY (ID),
	 CONSTRAINT "FK_FilmCast_Actors_ActorID" FOREIGN KEY (ACTOR_ID)
	  REFERENCES Actor (ID), 
	 CONSTRAINT "FK_FilmCast_Films_FilmID" FOREIGN KEY (FILM_ID)
	  REFERENCES Film (ID)
   );

  CREATE INDEX "IX_FilmCast_ActorID" ON FILM_CAST (ACTOR_ID);
  
  CREATE INDEX "IX_FilmCast_FilmID" ON FILM_CAST (FILM_ID);

